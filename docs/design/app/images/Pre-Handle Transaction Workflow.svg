<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1301px" height="391px" viewBox="-0.5 -0.5 1301 391" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="0" y="0" width="1300" height="390" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><rect x="530" y="40" width="730" height="310" fill="rgb(255, 255, 255)" stroke="#3a414a" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 728px; height: 1px; padding-top: 47px; margin-left: 531px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;"><font style="font-size: 14px;">Thread Pool</font></div></div></div></foreignObject><text x="895" y="57" fill="#3A414A" font-family="Helvetica" font-size="10px" text-anchor="middle" font-weight="bold">Thread Pool</text></switch></g><path d="M 150 140 L 363.63 140" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 368.88 140 L 361.88 143.5 L 363.63 140 L 361.88 136.5 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 121px; margin-left: 261px;"><div data-drawio-colors="color: #3A414A; background-color: rgb(255, 255, 255); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; background-color: rgb(255, 255, 255); white-space: nowrap;">Asynchronously but<br />BEFORE handle transaction</div></div></div></foreignObject><text x="261" y="124" fill="#3A414A" font-family="Helvetica" font-size="12px" text-anchor="middle">Asynchronously but...</text></switch></g><rect x="30" y="110" width="120" height="60" rx="9" ry="9" fill="#fff0fb" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 140px; margin-left: 31px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Platform</b></font></div></div></div></foreignObject><text x="90" y="144" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Platform</text></switch></g><rect x="370" y="110" width="120" height="60" rx="9" ry="9" fill="#d7faf5" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 140px; margin-left: 371px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>preHandle(s, e)</b><br /></font><span style="color: rgb(58, 65, 74); font-size: 10px;">submit to thread pool</span><font color="#3a414a"><br /></font></div></div></div></foreignObject><text x="430" y="144" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">preHandle(s, e)...</text></switch></g><path d="M 655 170 L 655 223.63" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 655 228.88 L 651.5 221.88 L 655 223.63 L 658.5 221.88 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><rect x="570" y="110" width="170" height="60" rx="9" ry="9" fill="#d7faf5" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 140px; margin-left: 571px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Parse Transaction</b><br /><font style="font-size: 10px;">and validate syntactically</font><br /></font></div></div></div></foreignObject><text x="655" y="144" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Parse Transaction...</text></switch></g><path d="M 490 140 L 563.63 140" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 568.88 140 L 561.88 143.5 L 563.63 140 L 561.88 136.5 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><path d="M 740 140 L 803.63 140" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 808.88 140 L 801.88 143.5 L 803.63 140 L 801.88 136.5 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><rect x="570" y="230" width="170" height="80" rx="8" ry="8" fill="#c3f7c8" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 270px; margin-left: 571px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Call PreTransactionHandler</b><br /><span style="font-size: 10px;">validate transaction semantically, gather required keys, warms caches, create TransactionMetadata</span><br /></font></div></div></div></foreignObject><text x="655" y="274" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Call PreTransactionHandler...</text></switch></g><path d="M 895 170 L 895 223.63" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 895 228.88 L 891.5 221.88 L 895 223.63 L 898.5 221.88 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><path d="M 980 140 L 1043.63 140" fill="none" stroke="#3a414a" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1048.88 140 L 1041.88 143.5 L 1043.63 140 L 1041.88 136.5 Z" fill="#3a414a" stroke="#3a414a" stroke-miterlimit="10" pointer-events="all"/><rect x="810" y="110" width="170" height="60" rx="9" ry="9" fill="#d7faf5" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 140px; margin-left: 811px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Prepare Signature-Data</b><br /><span style="font-size: 10px;">by loading signed bytes, <br />public keys, and signatures</span><br /></font></div></div></div></foreignObject><text x="895" y="144" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Prepare Signature-Data...</text></switch></g><rect x="810" y="230" width="170" height="60" rx="9" ry="9" fill="#fff0fb" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 260px; margin-left: 811px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Verify Signatures</b><br /><font style="font-size: 10px;">platform verifies signatures (sync)</font><br /></font></div></div></div></foreignObject><text x="895" y="264" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Verify Signatures...</text></switch></g><rect x="1050" y="110" width="170" height="60" rx="9" ry="9" fill="#d7faf5" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 140px; margin-left: 1051px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><font color="#3a414a"><b>Transaction Metadata</b><br /><span style="font-size: 10px;">result in Future at end of call</span><br /></font></div></div></div></foreignObject><text x="1135" y="144" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Transaction Metadata...</text></switch></g><ellipse cx="575" cy="105" rx="15" ry="15" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 105px; margin-left: 561px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="575" y="109" fill="#3A414A" font-family="Helvetica" font-size="14px" text-anchor="middle">1</text></switch></g><ellipse cx="575" cy="225" rx="15" ry="15" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 225px; margin-left: 561px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="575" y="229" fill="#3A414A" font-family="Helvetica" font-size="14px" text-anchor="middle">2</text></switch></g><ellipse cx="815" cy="105" rx="15" ry="15" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 105px; margin-left: 801px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="815" y="109" fill="#3A414A" font-family="Helvetica" font-size="14px" text-anchor="middle">3</text></switch></g><ellipse cx="815" cy="225" rx="15" ry="15" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 225px; margin-left: 801px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="815" y="229" fill="#3A414A" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g><rect x="30" y="210" width="480" height="140" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 472px; height: 1px; padding-top: 200px; margin-left: 35px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: left; max-height: 150px; overflow: hidden;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><h1>Pre-Handle Workflow</h1><p>The platform calls <font face="Courier New">preHandle</font> an event at a time, and always with the most recent immutable state. <font face="Courier New">preHandle</font> submits each <font face="Courier New">SwirldTransaction</font> to a thread pool for processing as a <font face="Courier New">Callable</font>, placing the <font face="Courier New">Future&lt;TransactionMetadata&gt; </font>on the <font face="Courier New">SwirldTransaction</font>.</p></div></div></div></foreignObject><text x="35" y="214" fill="#3A414A" font-family="Helvetica" font-size="14px">Pre-Handle Workflow...</text></switch></g><ellipse cx="1055" cy="105" rx="15" ry="15" fill="rgb(255, 255, 255)" stroke="#3a414a" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 105px; margin-left: 1041px;"><div data-drawio-colors="color: #3A414A; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(58, 65, 74); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="1055" y="109" fill="#3A414A" font-family="Helvetica" font-size="14px" text-anchor="middle">4</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>